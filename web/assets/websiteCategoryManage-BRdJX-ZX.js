import{c as e,ap as t,F as s,r as a,j as r,w as l,ax as i,B as n,ay as o,ac as c,O as m,a0 as d,ar as h,as as x,E as f,N as y,az as j,aa as p,e as u,D as b,C as _,H as g,ao as S}from"./main-yBlsCRjP.js";import{r as w}from"./transformData-kYduH2MM.js";import{M as C,R as k}from"./myTable-D6WWRlMD.js";import{C as N}from"./contentLayout-d9TsE5QA.js";import{R as F}from"./SortAscendingOutlined-BPOdfNtu.js";import"./MoneyCollectOutlined-CjD9F1Vp.js";import"./AlipayOutlined-kUdHxg6R.js";import"./index-BbfAH2u7.js";function v(){const y=e.c(41),{key:j,refresh:p}=t(),[u]=s.useForm();let b;y[0]===Symbol.for("react.memo_cache_sentinel")?(b={},y[0]=b):b=y[0];const[_,g]=a.useState(b);let S,k,F,v;y[1]===Symbol.for("react.memo_cache_sentinel")?(S={title:"分类名称",key:"name",width:160,fixed:"left"},k={title:"排序",key:"sort",width:80,render:I},F={title:"更新时间",key:"updatedTime",width:200,render:T},y[1]=S,y[2]=k,y[3]=F):(S=y[1],k=y[2],F=y[3]),y[4]!==p?(v=[S,k,F,{title:"操作",fixed:"right",width:120,render:(e,t)=>r.jsx(M,{record:t,refresh:p})}],y[4]=p,y[5]=v):v=y[5];const O=v;let z,A,L,R,q,D,K,V,B,E,H,P,U,Y,Z,$,G;return y[6]!==u?(z=()=>{const e=u.getFieldsValue();e[Math.random()]=!0,g(w(e))},y[6]=u,y[7]=z):z=y[7],y[8]===Symbol.for("react.memo_cache_sentinel")?(A={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},y[8]=A):A=y[8],y[9]===Symbol.for("react.memo_cache_sentinel")?(L=r.jsx("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:A,children:r.jsx(s.Item,{name:"name",children:r.jsx(l,{placeholder:"分类名称"})})}),y[9]=L):L=y[9],y[10]!==u?(R=()=>{u.submit()},y[10]=u,y[11]=R):R=y[11],y[12]===Symbol.for("react.memo_cache_sentinel")?(q=r.jsx(i,{}),y[12]=q):q=y[12],y[13]!==R?(D=r.jsx(n,{type:"primary",onClick:R,icon:q,children:"查询"}),y[13]=R,y[14]=D):D=y[14],y[15]!==u?(K=()=>{u.resetFields();const e={};e[Math.random()]=!0,g(e)},y[15]=u,y[16]=K):K=y[16],y[17]===Symbol.for("react.memo_cache_sentinel")?(V=r.jsx(o,{}),y[17]=V):V=y[17],y[18]!==K?(B=r.jsx(n,{onClick:K,icon:V,children:"重置"}),y[18]=K,y[19]=B):B=y[19],y[20]!==D||y[21]!==B?(E=r.jsxs("div",{className:"flex flex-wrap gap-3",children:[D,B]}),y[20]=D,y[21]=B,y[22]=E):E=y[22],y[23]!==u||y[24]!==E||y[25]!==z?(H=r.jsxs(s,{className:"w-full",form:u,onFinish:z,children:[L,E]}),y[23]=u,y[24]=E,y[25]=z,y[26]=H):H=y[26],y[27]===Symbol.for("react.memo_cache_sentinel")?(P=r.jsx(c,{type:"warning",description:r.jsxs(r.Fragment,{children:[r.jsx(m,{className:"mr-1"}),"收录分类在前端获取列表时做了 10 分钟的缓存效果，可能存在数据不及时更新情况，请重启或等待缓存失效"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),U=r.jsx(d,{className:"my-3"}),y[27]=P,y[28]=U):(P=y[27],U=y[28]),y[29]!==p?(Y=r.jsx("div",{className:"mb-3",children:r.jsx(n,{type:"primary",onClick:()=>{h.show(x,{title:"新增分类",children:r.jsx(W,{refresh:p,type:"add"})})},children:"新增分类"})}),y[29]=p,y[30]=Y):Y=y[30],y[31]!==_?(Z={searchParams:_},y[31]=_,y[32]=Z):Z=y[32],y[33]!==O||y[34]!==j||y[35]!==Z?($=r.jsx(C,{columns:O,getListUrl:f.getWebsiteCategoryList,dataKey:"data.list",tableKey:j,params:Z}),y[33]=O,y[34]=j,y[35]=Z,y[36]=$):$=y[36],y[37]!==H||y[38]!==Y||y[39]!==$?(G=r.jsxs(N,{children:[H,P,U,Y,$]}),y[37]=H,y[38]=Y,y[39]=$,y[40]=G):G=y[40],G}function T(e,t){return r.jsx(y,{icon:r.jsx(j,{}),children:e||t.createdTime})}function I(e){return r.jsx(y,{color:"gold",icon:r.jsx(F,{}),children:e||"-"})}const W=t=>{const i=e.c(16),{editItem:o,refresh:c,type:m}=t,d=void 0===m?"add":m,[y]=s.useForm(),[j,_]=a.useState(!1);let g;i[0]!==o||i[1]!==c||i[2]!==d?(g=function(e){_(!0);const t=u.getState().user.token;b({url:"add"===d?f.addWebsiteCategory:f.editWebsiteCategory,token:t,data:"add"===d?e:{...e,id:o.id}}).then(e=>{200===e?.code&&(h.hide(x),c&&c())}).finally(()=>{_(!1)})},i[0]=o,i[1]=c,i[2]=d,i[3]=g):g=i[3];const S=g;let w,C,k,N;i[4]===Symbol.for("react.memo_cache_sentinel")?(w={flex:"82px"},i[4]=w):w=i[4],i[5]===Symbol.for("react.memo_cache_sentinel")?(C=r.jsx(s.Item,{name:"name",label:"分类名称",required:!0,rules:[{required:!0}],children:r.jsx(l,{placeholder:"分类名称",allowClear:!0})}),i[5]=C):C=i[5],i[6]===Symbol.for("react.memo_cache_sentinel")?(k=r.jsx(s.Item,{name:"sort",label:"排序",children:r.jsx(p,{placeholder:"排序"})}),i[6]=k):k=i[6],i[7]===Symbol.for("react.memo_cache_sentinel")?(N=r.jsx(n,{onClick:O,children:"取消"}),i[7]=N):N=i[7];const F="add"===d?"新增分类":"保存编辑";let v,T;return i[8]!==j||i[9]!==F?(v=r.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[N,r.jsx(n,{type:"primary",htmlType:"submit",loading:j,children:F})]}),i[8]=j,i[9]=F,i[10]=v):v=i[10],i[11]!==o||i[12]!==y||i[13]!==S||i[14]!==v?(T=r.jsx(r.Fragment,{children:r.jsxs(s,{form:y,autoComplete:"off",variant:"filled",initialValues:o,labelCol:w,onFinish:S,children:[C,k,v]})}),i[11]=o,i[12]=y,i[13]=S,i[14]=v,i[15]=T):T=i[15],T},M=a.memo(t=>{const s=e.c(20),{record:l,refresh:i}=t;let o;s[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],s[0]=o):o=s[0];const[c,m]=a.useState(o);let d;s[1]!==l||s[2]!==i?(d=function(){_(1,m);const e=u.getState().user.token;setTimeout(()=>{b({url:f.deleteWebsiteCategory,token:e,data:{id:l.id}}).then(e=>{200===e?.code&&i()}).finally(()=>{g(1,m)})},500)},s[1]=l,s[2]=i,s[3]=d):d=s[3];const y=d;let j,p,w,C,N,F,v;return s[4]===Symbol.for("react.memo_cache_sentinel")?(j={width:"44px"},s[4]=j):j=s[4],s[5]!==l||s[6]!==i?(p=r.jsx(n,{type:"link",size:"small",style:j,onClick:()=>{h.show(x,{title:"编辑分类",children:r.jsx(W,{editItem:l,refresh:i,type:"edit"})})},children:"编辑"}),s[5]=l,s[6]=i,s[7]=p):p=s[7],s[8]===Symbol.for("react.memo_cache_sentinel")?(w={width:"44px"},s[8]=w):w=s[8],s[9]!==c[1]?(C=c[1]?r.jsx(k,{}):"删除",s[9]=c[1],s[10]=C):C=s[10],s[11]!==c[1]||s[12]!==C?(N=r.jsx(n,{danger:!0,type:"link",size:"small",disabled:c[1],style:w,children:C}),s[11]=c[1],s[12]=C,s[13]=N):N=s[13],s[14]!==y||s[15]!==N?(F=r.jsx(S,{title:"是否确认删除？",onConfirm:y,children:N}),s[14]=y,s[15]=N,s[16]=F):F=s[16],s[17]!==p||s[18]!==F?(v=r.jsxs("div",{className:"flex flex-wrap",children:[p,F]}),s[17]=p,s[18]=F,s[19]=v):v=s[19],v});function O(){h.hide(x)}export{v as default};
