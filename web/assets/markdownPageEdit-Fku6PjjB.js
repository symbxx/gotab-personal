import{c as e,r as t,j as a,ak as n,k as o,B as s,n as l,C as r,ab as c,H as u,D as i,G as m,al as d,E as f}from"./main-KjJepRzY.js";import{E as p}from"./index-DPTX5tSC.js";import{C as b}from"./contentLayout-qHWurPv1.js";function x(){const o=e.c(3),[s,l]=t.useState("aboutUs");let r,c;return o[0]===Symbol.for("react.memo_cache_sentinel")?(r=a.jsx(n,{options:[{label:"关于我们",value:"aboutUs"},{label:"捐赠打赏",value:"donate"}],onChange:e=>{l(e)},className:"mb-3"}),o[0]=r):r=o[0],o[1]!==s?(c=a.jsxs(b,{children:[r,a.jsx(h,{type:s})]}),o[1]=s,o[2]=c):c=o[2],c}const h=n=>{const d=e.c(29),{type:b}=n,[x,h]=t.useState("");let y;d[0]===Symbol.for("react.memo_cache_sentinel")?(y=[],d[0]=y):y=d[0];const[C,U]=t.useState(y),_=o(g);let k;d[1]===Symbol.for("react.memo_cache_sentinel")?(k=new AbortController,d[1]=k):k=d[1];const w=t.useRef(k);let S;d[2]!==_||d[3]!==b?(S=function(){w.current.abort(),w.current=new AbortController,r(0,U),c({url:"aboutUs"===b?f.getAboutUsContent:f.getDonateContent,token:_,signal:w.current.signal}).then(e=>{200===e?.code&&("aboutUs"===b?h(e.data.aboutUs):"donate"===b&&h(e.data.donate))}).finally(()=>{u(0,U)})},d[2]=_,d[3]=b,d[4]=S):S=d[4];const N=S;let v,A,E;d[5]!==N?(v=()=>{N()},d[5]=N,d[6]=v):v=d[6],d[7]!==b?(A=[b],d[7]=b,d[8]=A):A=d[8],t.useEffect(v,A),d[9]!==_?(E=function(e){return new Promise(t=>{i({url:f.uploadImage,token:_,data:m({file:e})}).then(e=>{200===e?.code&&e.data&&t(e.data.image_url)})})},d[9]=_,d[10]=E):E=d[10];const D=E;let H;d[11]!==x||d[12]!==_||d[13]!==b?(H=function(){r(1,U),i({url:"aboutUs"===b?f.updateAboutUsContent:f.updateDonateContent,token:_,data:{content:x}}).finally(()=>{u(1,U)})},d[11]=x,d[12]=_,d[13]=b,d[14]=H):H=d[14];const I=H;let L,z,B,G,M,P;return d[15]===Symbol.for("react.memo_cache_sentinel")?(L={height:"calc(100% - 44px)"},z=e=>{h(e.text)},d[15]=L,d[16]=z):(L=d[15],z=d[16]),d[17]!==D||d[18]!==x?(B=a.jsx(p,{className:"flex-1",style:L,onChange:z,value:x,renderHTML:j,onImageUpload:D}),d[17]=D,d[18]=x,d[19]=B):B=d[19],d[20]!==C[1]||d[21]!==I?(G=a.jsx("div",{className:"flex justify-end gap-3 flex-wrap mt-3",children:a.jsx(s,{loading:C[1],type:"primary",onClick:I,children:"保存配置"})}),d[20]=C[1],d[21]=I,d[22]=G):G=d[22],d[23]!==G||d[24]!==B?(M=a.jsxs("main",{className:"w-full h-[480px]",children:[B,G]}),d[23]=G,d[24]=B,d[25]=M):M=d[25],d[26]!==C[0]||d[27]!==M?(P=a.jsx(l,{size:"large",spinning:C[0],wrapperClassName:"w-full",children:M}),d[26]=C[0],d[27]=M,d[28]=P):P=d[28],P};function g(e){return e.user.token}function j(e){return a.jsx(d,{content:e,replace:!1,isEditor:!0})}export{x as default};
