import{c as e,ap as t,F as a,r as l,j as r,x as s,N as n,ax as o,B as i,ay as c,a1 as m,G as d,O as h,aq as f,aB as u,v as x,aH as p,D as y,e as j,E as b,J as _,aI as g,ao as k}from"./main-DBCALU0b.js";import{r as w}from"./transformData-_VI0jaUu.js";import{M as S,R as v}from"./myTable-Bsgor84R.js";import{C}from"./contentLayout-BIZLtLYj.js";import"./LoadingOutlined-DuYkz5sN.js";import"./MoneyCollectOutlined-DWZamemE.js";import"./AlipayOutlined-BdDYnCVD.js";function F(){const h=e.c(43),{key:f,refresh:u}=t(),[x]=a.useForm();let p;h[0]===Symbol.for("react.memo_cache_sentinel")?(p={},h[0]=p):p=h[0];const[y,j]=l.useState(p);let b,_,g,k,v,F,M,$;h[1]===Symbol.for("react.memo_cache_sentinel")?(b={title:"用户",key:"username",width:160,fixed:"left",render:I},_={title:"预览",key:"filePath",width:160,render:T},g={title:"资源类型",key:"srcType",width:120,render:P},k={title:"文件类型",key:"fileType",width:120},v={title:"文件大小",key:"fileSize",width:120,render:N},F={title:"文件地址",key:"filePath",width:420,render:B},M={type:"time",title:"上传时间",key:"createdTime",width:200},h[1]=b,h[2]=_,h[3]=g,h[4]=k,h[5]=v,h[6]=F,h[7]=M):(b=h[1],_=h[2],g=h[3],k=h[4],v=h[5],F=h[6],M=h[7]),h[8]!==u?($=[b,_,g,k,v,F,M,{title:"操作",fixed:"right",width:120,render:(e,t)=>r.jsx(z,{record:t,refresh:u})}],h[8]=u,h[9]=$):$=h[9];const A=$;let L,O,K,U,D,G,H,R,q,E,J,V,Y,Q,W,X,Z;return h[10]!==x?(L=()=>{const e=x.getFieldsValue();e[Math.random()]=!0,j(w(e))},h[10]=x,h[11]=L):L=h[11],h[12]===Symbol.for("react.memo_cache_sentinel")?(O={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},h[12]=O):O=h[12],h[13]===Symbol.for("react.memo_cache_sentinel")?(K=r.jsx(a.Item,{name:"username",children:r.jsx(s,{placeholder:"用户名"})}),h[13]=K):K=h[13],h[14]===Symbol.for("react.memo_cache_sentinel")?(U=r.jsx(a.Item,{name:"filePath",children:r.jsx(s,{placeholder:"文件地址"})}),h[14]=U):U=h[14],h[15]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsxs("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:O,children:[K,U,r.jsx(a.Item,{name:"srcType",children:r.jsx(n,{placeholder:"资源类型",options:[{label:"头像",value:1},{label:"静态壁纸",value:2},{label:"动态壁纸",value:3},{label:"上传的图标",value:4},{label:"自动获取的图标",value:5},{label:"资源库的图标",value:6},{label:"其他图片",value:0}],allowClear:!0})})]}),h[15]=D):D=h[15],h[16]!==x?(G=()=>{x.submit()},h[16]=x,h[17]=G):G=h[17],h[18]===Symbol.for("react.memo_cache_sentinel")?(H=r.jsx(o,{}),h[18]=H):H=h[18],h[19]!==G?(R=r.jsx(i,{type:"primary",onClick:G,icon:H,children:"查询"}),h[19]=G,h[20]=R):R=h[20],h[21]!==x?(q=()=>{x.resetFields();const e={};e[Math.random()]=!0,j(e)},h[21]=x,h[22]=q):q=h[22],h[23]===Symbol.for("react.memo_cache_sentinel")?(E=r.jsx(c,{}),h[23]=E):E=h[23],h[24]!==q?(J=r.jsx(i,{onClick:q,icon:E,children:"重置"}),h[24]=q,h[25]=J):J=h[25],h[26]!==R||h[27]!==J?(V=r.jsxs("div",{className:"flex flex-wrap gap-3",children:[R,J]}),h[26]=R,h[27]=J,h[28]=V):V=h[28],h[29]!==x||h[30]!==V||h[31]!==L?(Y=r.jsxs(a,{className:"w-full",form:x,onFinish:L,children:[D,V]}),h[29]=x,h[30]=V,h[31]=L,h[32]=Y):Y=h[32],h[33]===Symbol.for("react.memo_cache_sentinel")?(Q=r.jsx(m,{className:"my-3"}),h[33]=Q):Q=h[33],h[34]!==y?(W={searchParams:y},h[34]=y,h[35]=W):W=h[35],h[36]!==A||h[37]!==f||h[38]!==W?(X=r.jsx(S,{columns:A,getListUrl:d.getUploadSrcList,dataKey:"data.list",tableKey:f,params:W}),h[36]=A,h[37]=f,h[38]=W,h[39]=X):X=h[39],h[40]!==Y||h[41]!==X?(Z=r.jsxs(C,{children:[Y,Q,X]}),h[40]=Y,h[41]=X,h[42]=Z):Z=h[42],Z}function B(e){return r.jsx(h,{color:"blue",onClick:()=>{e&&window.open(x(e),"_blank")},className:"cursor-pointer",icon:r.jsx(p,{}),children:e||"-"})}function N(e){return r.jsx("span",{children:e<1024?`${e}B`:e<1048576?`${(e/1024).toFixed(2)}KB`:e<1073741824?`${(e/1024/1024).toFixed(2)}MB`:`${(e/1024/1024/1024).toFixed(2)}GB`})}function P(e){return r.jsx(h,{color:0===e?"blue":1===e?"green":2===e?"purple":3===e?"cyan":4===e?"red":5===e?"orange":6===e?"magenta":"volcano",children:0===e?"其他图片":1===e?"头像":2===e?"静态壁纸":3===e?"动态壁纸":4===e?"上传的图标":5===e?"自动获取的图标":6===e?"资源库的图标":e})}function T(e){return r.jsx(u,{src:x(e),height:48,loading:"lazy",fallback:"/icons/default_image.svg"})}function I(e,t){return r.jsx(h,{color:e||"0"===t.userId?"geekblue":"red",bordered:!1,icon:r.jsx(f,{}),children:e||("0"===t.userId?"游客":"已注销")})}const z=l.memo(t=>{const a=e.c(20),{record:s,refresh:n}=t;let o;a[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],a[0]=o):o=a[0];const[c,m]=l.useState(o);let h;a[1]!==s.id||a[2]!==n?(h=function(){y(1,m);const e=j.getState().user.token;setTimeout(()=>{b({url:d.deleteUploadSrc,token:e,data:{ids:[s.id]}}).then(e=>{200===e?.code&&n()}).finally(()=>{_(1,m)})},500)},a[1]=s.id,a[2]=n,a[3]=h):h=a[3];const f=h;let u;a[4]===Symbol.for("react.memo_cache_sentinel")?(u=function(e){fetch(x(e),{headers:new Headers({Authorization:"Bearer "+j.getState().user.token})}).then(M).then(t=>{g.saveAs(t,e.split("/").pop()||"file")}).catch($)},a[4]=u):u=a[4];const p=u;let w,S,C,F,B,N,P;return a[5]===Symbol.for("react.memo_cache_sentinel")?(w={width:"44px"},a[5]=w):w=a[5],a[6]!==s.filePath?(S=r.jsx(i,{type:"link",size:"small",style:w,onClick:()=>{p(s.filePath)},children:"下载"}),a[6]=s.filePath,a[7]=S):S=a[7],a[8]===Symbol.for("react.memo_cache_sentinel")?(C={width:"44px"},a[8]=C):C=a[8],a[9]!==c[1]?(F=c[1]?r.jsx(v,{}):"删除",a[9]=c[1],a[10]=F):F=a[10],a[11]!==c[1]||a[12]!==F?(B=r.jsx(i,{danger:!0,type:"link",size:"small",disabled:c[1],style:C,children:F}),a[11]=c[1],a[12]=F,a[13]=B):B=a[13],a[14]!==f||a[15]!==B?(N=r.jsx(k,{title:"是否删除附件？",onConfirm:f,children:B}),a[14]=f,a[15]=B,a[16]=N):N=a[16],a[17]!==S||a[18]!==N?(P=r.jsxs("div",{className:"flex flex-wrap",children:[S,N]}),a[17]=S,a[18]=N,a[19]=P):P=a[19],P});function M(e){return e.blob()}function $(){return alert("文件下载失败")}export{F as default};
