import{c as e,ap as r,F as t,r as s,j as l,w as a,ax as n,B as o,ay as i,a0 as c,ar as m,as as d,E as h,N as u,aB as p,q as y,aF as x,aG as f,e as j,D as w,C as _,H as b,ao as g}from"./main-CZX57bh3.js";import{r as k}from"./transformData-BNZALuk1.js";import{M as S,R as T}from"./myTable-BFrsHbph.js";import{C}from"./contentLayout-CtF6294c.js";import"./MoneyCollectOutlined-Cy-ZG86D.js";import"./AlipayOutlined-C07KGgJF.js";import"./index-FZwoVPSG.js";function v(){const u=e.c(50),{key:p,refresh:y}=r(),[x]=t.useForm();let f;u[0]===Symbol.for("react.memo_cache_sentinel")?(f={},u[0]=f):f=u[0];const[j,w]=s.useState(f);let _,b,g,T,v,L,U,$,M,q,K,B;u[1]===Symbol.for("react.memo_cache_sentinel")?(_={title:"用户名",key:"username",width:160,fixed:"left"},T={title:"用户类型",key:"userType",width:120,render:F},v={title:"头像",key:"avatar",width:120,render:E},L={title:"昵称",key:"nickname",width:160},U={type:"sex",title:"性别",key:"sex",width:60},$={title:"邮箱",key:"email",width:200,render:A},M={title:"手机号",key:"phone",width:160,render:z},q={title:"称号",key:"appellation",width:200,render:P},K={title:"称号状态",key:"appellation_status",width:120,render:I},b={type:"time",title:"注册时间",key:"createdTime",width:200},g={type:"time",title:"更新时间",key:"updatedTime",width:200},u[1]=_,u[2]=b,u[3]=g,u[4]=T,u[5]=v,u[6]=L,u[7]=U,u[8]=$,u[9]=M,u[10]=q,u[11]=K):(_=u[1],b=u[2],g=u[3],T=u[4],v=u[5],L=u[6],U=u[7],$=u[8],M=u[9],q=u[10],K=u[11]),u[12]!==y?(B=[_,T,v,L,U,$,M,q,K,b,g,{title:"操作",fixed:"right",width:180,render:(e,r)=>l.jsx(Z,{record:r,refresh:y})}],u[12]=y,u[13]=B):B=u[13];const D=B;let O,R,G,H,V,W,Y,J,Q,X,ee,re,te,se,le,ae,ne,oe;return u[14]!==x?(O=()=>{const e=x.getFieldsValue();e[Math.random()]=!0,w(k(e))},u[14]=x,u[15]=O):O=u[15],u[16]===Symbol.for("react.memo_cache_sentinel")?(R={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},u[16]=R):R=u[16],u[17]===Symbol.for("react.memo_cache_sentinel")?(G=l.jsx(t.Item,{name:"username",children:l.jsx(a,{placeholder:"用户名"})}),u[17]=G):G=u[17],u[18]===Symbol.for("react.memo_cache_sentinel")?(H=l.jsx(t.Item,{name:"email",children:l.jsx(a,{placeholder:"邮箱"})}),u[18]=H):H=u[18],u[19]===Symbol.for("react.memo_cache_sentinel")?(V=l.jsxs("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:R,children:[G,H,l.jsx(t.Item,{name:"phone",children:l.jsx(a,{placeholder:"手机号"})})]}),u[19]=V):V=u[19],u[20]!==x?(W=()=>{x.submit()},u[20]=x,u[21]=W):W=u[21],u[22]===Symbol.for("react.memo_cache_sentinel")?(Y=l.jsx(n,{}),u[22]=Y):Y=u[22],u[23]!==W?(J=l.jsx(o,{type:"primary",onClick:W,icon:Y,children:"查询"}),u[23]=W,u[24]=J):J=u[24],u[25]!==x?(Q=()=>{x.resetFields();const e={};e[Math.random()]=!0,w(e)},u[25]=x,u[26]=Q):Q=u[26],u[27]===Symbol.for("react.memo_cache_sentinel")?(X=l.jsx(i,{}),u[27]=X):X=u[27],u[28]!==Q?(ee=l.jsx(o,{onClick:Q,icon:X,children:"重置"}),u[28]=Q,u[29]=ee):ee=u[29],u[30]!==J||u[31]!==ee?(re=l.jsxs("div",{className:"flex flex-wrap gap-3",children:[J,ee]}),u[30]=J,u[31]=ee,u[32]=re):re=u[32],u[33]!==x||u[34]!==O||u[35]!==re?(te=l.jsxs(t,{className:"w-full",form:x,onFinish:O,children:[V,re]}),u[33]=x,u[34]=O,u[35]=re,u[36]=te):te=u[36],u[37]===Symbol.for("react.memo_cache_sentinel")?(se=l.jsx(c,{className:"my-3"}),u[37]=se):se=u[37],u[38]!==y?(le=l.jsx("div",{className:"mb-3",children:l.jsx(o,{type:"primary",onClick:()=>{m.show(d,{title:"新增用户",children:l.jsx(N,{refresh:y})})},children:"新增用户"})}),u[38]=y,u[39]=le):le=u[39],u[40]!==j?(ae={searchParams:j},u[40]=j,u[41]=ae):ae=u[41],u[42]!==D||u[43]!==p||u[44]!==ae?(ne=l.jsx(S,{columns:D,getListUrl:h.getAwaitingApprovalUserAppellationList,dataKey:"data.list",rowKey:"userId",tableKey:p,params:ae}),u[42]=D,u[43]=p,u[44]=ae,u[45]=ne):ne=u[45],u[46]!==te||u[47]!==le||u[48]!==ne?(oe=l.jsxs(C,{children:[te,se,le,ne]}),u[46]=te,u[47]=le,u[48]=ne,u[49]=oe):oe=u[49],oe}function I(e,r){return l.jsx(u,{color:0===e?r.appellation?"blue":"default":1===e?"green":"red",children:0===e?r.appellation?"待审核":"未申请":1===e?"已荣获":"被拒绝"})}function P(e){return e?l.jsx(u,{className:"flex items-center gap-1 w-fit",icon:l.jsx(f,{}),children:e||"-"}):"-"}function z(e){return l.jsx(o,{type:"text",size:"small",onClick:()=>{x(e,!0)},children:e||"-"})}function A(e){return l.jsx(o,{type:"text",size:"small",onClick:()=>{x(e,!0)},children:e||"-"})}function E(e){return e?l.jsx(p,{src:y(e),height:48,loading:"lazy",fallback:"/icons/default_image.svg"}):"-"}function F(e){return l.jsx(u,{bordered:!1,color:0===e?"blue":"volcano",children:1===e?"管理员":"普通用户"})}const N=r=>{const n=e.c(13),{refresh:i}=r,[c]=t.useForm(),[u,p]=s.useState(!1);let y;n[0]!==i?(y=function(e){p(!0);const r=j.getState().user.token;w({url:h.addUser,token:r,data:e}).then(e=>{200===e?.code&&(m.hide(d),i&&i())}).finally(()=>{p(!1)})},n[0]=i,n[1]=y):y=n[1];const x=y;let f,_,b,g,k,S,T;return n[2]===Symbol.for("react.memo_cache_sentinel")?(f={flex:"82px"},n[2]=f):f=n[2],n[3]===Symbol.for("react.memo_cache_sentinel")?(_=l.jsx(t.Item,{name:"username",label:"用户名",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z]/.test(r)?/^[a-zA-Z][a-zA-Z0-9_-]*$/.test(r)?r.length<3||r.length>20?Promise.reject(new Error("用户名长度必须在3到20位之间")):Promise.resolve():Promise.reject(new Error("用户名只能包含字母、数字、下划线或短横线")):Promise.reject(new Error("用户名必须以字母开头")):Promise.reject(new Error("请输入用户名"))}],children:l.jsx(a,{placeholder:"用户名",allowClear:!0,maxLength:20})}),n[3]=_):_=n[3],n[4]===Symbol.for("react.memo_cache_sentinel")?(b=l.jsx(t.Item,{label:"密码",name:"password",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z0-9_\-!@#$%^&*()+={}[\]:;"'<>.,?/~`|]+$/.test(r)?r.length<6||r.length>32?Promise.reject(new Error("密码长度必须在6到32位之间")):Promise.resolve():Promise.reject(new Error("密码只能包含字母、数字、下划线、短横线以及其他常用特殊字符")):Promise.reject(new Error("请输入密码"))}],children:l.jsx(a.Password,{autoComplete:"new-password",placeholder:"密码",allowClear:!0,maxLength:32})}),n[4]=b):b=n[4],n[5]===Symbol.for("react.memo_cache_sentinel")?(g=l.jsx(t.Item,{label:"邮箱",name:"email",rules:[{validator(e,r){if(!r)return Promise.resolve();return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)?Promise.resolve():Promise.reject(new Error("请输入有效的邮箱地址"))}}],children:l.jsx(a,{placeholder:"邮箱",allowClear:!0})}),n[5]=g):g=n[5],n[6]===Symbol.for("react.memo_cache_sentinel")?(k=l.jsx(o,{onClick:L,children:"取消"}),n[6]=k):k=n[6],n[7]!==u?(S=l.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[k,l.jsx(o,{type:"primary",htmlType:"submit",loading:u,children:"新增用户"})]}),n[7]=u,n[8]=S):S=n[8],n[9]!==c||n[10]!==x||n[11]!==S?(T=l.jsx(l.Fragment,{children:l.jsxs(t,{form:c,autoComplete:"off",variant:"filled",labelCol:f,onFinish:x,children:[_,b,g,S]})}),n[9]=c,n[10]=x,n[11]=S,n[12]=T):T=n[12],T},Z=s.memo(r=>{const t=e.c(35),{record:a,refresh:n}=r;let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i=[],t[0]=i):i=t[0];const[c,m]=s.useState(i);let d;t[1]!==a.userId||t[2]!==a.userType||t[3]!==n?(d=function(e){_(e,m);const r=j.getState().user.token;setTimeout(()=>{w({url:h.setUserType,token:r,data:{userId:a.userId,type:1===a.userType?0:1}}).then(e=>{200===e?.code&&n()}).finally(()=>{b(e,m)})},500)},t[1]=a.userId,t[2]=a.userType,t[3]=n,t[4]=d):d=t[4];const u=d;let p;t[5]!==a.userId||t[6]!==n?(p=function(){_(2,m);const e=j.getState().user.token;setTimeout(()=>{w({url:h.deleteUser,token:e,data:{userId:a.userId}}).then(e=>{200===e?.code&&n()}).finally(()=>{b(2,m)})},500)},t[5]=a.userId,t[6]=n,t[7]=p):p=t[7];const y=p,x=0===a.userType?"是否设为管理员？":"是否取消管理员？";let f;t[8]!==u||t[9]!==a.userType?(f=()=>{u(0===a.userType?0:1)},t[8]=u,t[9]=a.userType,t[10]=f):f=t[10];const k=1===a.userType;let S,C,v,I,P,z,A,E,F;return t[11]===Symbol.for("react.memo_cache_sentinel")?(S={width:"86px"},t[11]=S):S=t[11],t[12]!==c[0]||t[13]!==a.userType?(C=c[0]?l.jsx(T,{}):0===a.userType?"设为管理员":"取消管理员",t[12]=c[0],t[13]=a.userType,t[14]=C):C=t[14],t[15]!==c[0]||t[16]!==k||t[17]!==C?(v=l.jsx(o,{danger:k,type:"link",size:"small",disabled:c[0],style:S,children:C}),t[15]=c[0],t[16]=k,t[17]=C,t[18]=v):v=t[18],t[19]!==x||t[20]!==f||t[21]!==v?(I=l.jsx(g,{title:x,onConfirm:f,children:v}),t[19]=x,t[20]=f,t[21]=v,t[22]=I):I=t[22],t[23]===Symbol.for("react.memo_cache_sentinel")?(P={root:{maxWidth:"200px"}},t[23]=P):P=t[23],t[24]!==c[2]?(z=c[2]?l.jsx(T,{}):"注销",t[24]=c[2],t[25]=z):z=t[25],t[26]!==c[2]||t[27]!==z?(A=l.jsx(o,{danger:!0,type:"link",size:"small",disabled:c[2],children:z}),t[26]=c[2],t[27]=z,t[28]=A):A=t[28],t[29]!==y||t[30]!==A?(E=l.jsx(g,{title:"是否确认注销用户？将清空用户所有数据！",onConfirm:y,styles:P,children:A}),t[29]=y,t[30]=A,t[31]=E):E=t[31],t[32]!==E||t[33]!==I?(F=l.jsxs("div",{className:"flex flex-wrap",children:[I,E]}),t[32]=E,t[33]=I,t[34]=F):F=t[34],F});function L(){m.hide(d)}export{v as default};
